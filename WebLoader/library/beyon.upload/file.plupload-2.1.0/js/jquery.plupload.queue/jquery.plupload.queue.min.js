(function(b){function c(b){return plupload.translate(b)||b}function q(f,h){h.contents().each(function(f,c){c=b(c);c.is(".plupload")||c.remove()});h.prepend('\x3cdiv class\x3d"plupload_wrapper plupload_scroll"\x3e\x3cdiv id\x3d"'+f+'_container" class\x3d"plupload_container"\x3e\x3cdiv class\x3d"plupload"\x3e\x3cdiv class\x3d"plupload_header"\x3e\x3cdiv class\x3d"plupload_header_content"\x3e\x3cdiv class\x3d"plupload_header_title"\x3e'+c("Select files")+'\x3c/div\x3e\x3cdiv class\x3d"plupload_header_text"\x3e'+c("Add files to the upload queue and click the start button.")+'\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"plupload_content"\x3e\x3cdiv class\x3d"plupload_filelist_header"\x3e\x3cdiv class\x3d"plupload_file_name"\x3e'+c("Filename")+'\x3c/div\x3e\x3cdiv class\x3d"plupload_file_action"\x3e\x26nbsp;\x3c/div\x3e\x3cdiv class\x3d"plupload_file_status"\x3e\x3cspan\x3e'+c("Status")+'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"plupload_file_size"\x3e'+c("Size")+'\x3c/div\x3e\x3cdiv class\x3d"plupload_clearer"\x3e\x26nbsp;\x3c/div\x3e\x3c/div\x3e\x3cul id\x3d"'+f+'_filelist" class\x3d"plupload_filelist"\x3e\x3c/ul\x3e\x3cdiv class\x3d"plupload_filelist_footer"\x3e\x3cdiv class\x3d"plupload_file_name"\x3e\x3cdiv class\x3d"plupload_buttons"\x3e\x3ca href\x3d"#" class\x3d"plupload_button plupload_add" id\x3d"'+f+'_browse"\x3e'+c("Add Files")+'\x3c/a\x3e\x3ca href\x3d"#" class\x3d"plupload_button plupload_start"\x3e'+c("Start Upload")+'\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d"plupload_upload_status"\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"plupload_file_action"\x3e\x3c/div\x3e\x3cdiv class\x3d"plupload_file_status"\x3e\x3cspan class\x3d"plupload_total_status"\x3e0%\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"plupload_file_size"\x3e\x3cspan class\x3d"plupload_total_file_size"\x3e0 b\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"plupload_progress"\x3e\x3cdiv class\x3d"plupload_progress_container"\x3e\x3cdiv class\x3d"plupload_progress_bar"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"plupload_clearer"\x3e\x26nbsp;\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cinput type\x3d"hidden" id\x3d"'+f+'_count" name\x3d"'+f+'_count" value\x3d"0" /\x3e\x3c/div\x3e')}var m={};b.fn.pluploadQueue=function(f){return f?(this.each(function(){function h(a){var e;a.status==plupload.DONE&&(e="plupload_done");a.status==plupload.FAILED&&(e="plupload_failed");a.status==plupload.QUEUED&&(e="plupload_delete");a.status==plupload.UPLOADING&&(e="plupload_uploading");e=b("#"+a.id).attr("class",e).find("a").css("display","block");a.hint&&e.attr("title",a.hint)}function p(){b("span.plupload_total_status",d).html(a.total.percent+"%");b("div.plupload_progress_bar",d).css("width",a.total.percent+"%");b("span.plupload_upload_status",d).html(c("Uploaded %d/%d files").replace(/%d\/%d/,a.total.uploaded+"/"+a.files.length))}function l(){var f=b("ul.plupload_filelist",d).html(""),e=0,k;b.each(a.files,function(d,c){k="";c.status==plupload.DONE&&(c.target_name&&(k+='\x3cinput type\x3d"hidden" name\x3d"'+g+"_"+e+'_tmpname" value\x3d"'+plupload.xmlEncode(c.target_name)+'" /\x3e'),k+='\x3cinput type\x3d"hidden" name\x3d"'+g+"_"+e+'_name" value\x3d"'+plupload.xmlEncode(c.name)+'" /\x3e',k+='\x3cinput type\x3d"hidden" name\x3d"'+g+"_"+e+'_status" value\x3d"'+(c.status==plupload.DONE?"done":"failed")+'" /\x3e',e++,b("#"+g+"_count").val(e));f.append('\x3cli id\x3d"'+c.id+'"\x3e\x3cdiv class\x3d"plupload_file_name"\x3e\x3cspan\x3e'+c.name+'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"plupload_file_action"\x3e\x3ca href\x3d"#"\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"plupload_file_status"\x3e'+c.percent+'%\x3c/div\x3e\x3cdiv class\x3d"plupload_file_size"\x3e'+plupload.formatSize(c.size)+'\x3c/div\x3e\x3cdiv class\x3d"plupload_clearer"\x3e\x26nbsp;\x3c/div\x3e'+k+"\x3c/li\x3e");h(c);b("#"+c.id+".plupload_delete a").click(function(e){b("#"+c.id).remove();a.removeFile(c);e.preventDefault()})});b("span.plupload_total_file_size",d).html(plupload.formatSize(a.total.size));0===a.total.queued?b("span.plupload_add_text",d).html(c("Add Files")):b("span.plupload_add_text",d).html(c("%d files queued").replace(/%d/,a.total.queued));b("a.plupload_start",d).toggleClass("plupload_disabled",a.files.length==a.total.uploaded+a.total.failed);f[0].scrollTop=f[0].scrollHeight;p();!a.files.length&&a.features.dragdrop&&a.settings.dragdrop&&b("#"+g+"_filelist").append('\x3cli class\x3d"plupload_droptext"\x3e'+c("Drag files here.")+"\x3c/li\x3e")}var a,d,g,n;d=b(this);g=d.attr("id");g||(g=plupload.guid(),d.attr("id",g));n=d.html();q(g,d);f=b.extend({dragdrop:!0,browse_button:g+"_browse",container:g},f);f.dragdrop&&(f.drop_element=g+"_filelist");a=new plupload.Uploader(f);m[g]=a;a.bind("UploadFile",function(a,c){b("#"+c.id).addClass("plupload_current_file")});a.bind("Init",function(c,e){if(!f.unique_names&&f.rename)d.on("click","#"+g+"_filelist div.plupload_file_name span",function(a){var e=b(a.target),d,f,g="";d=c.getFile(e.parents("li")[0].id);f=d.name;if(a=/^(.+)(\.[^.]+)$/.exec(f))f=a[1],g=a[2];e.hide().after('\x3cinput type\x3d"text" /\x3e');e.next().val(f).focus().blur(function(){e.show().next().remove()}).keydown(function(a){var c=b(this);13==a.keyCode&&(a.preventDefault(),d.name=c.val()+g,e.html(d.name),c.blur())})});b("#"+g+"_container").attr("title","Using runtime: "+e.runtime);b("a.plupload_start",d).click(function(c){b(this).hasClass("plupload_disabled")||a.start();c.preventDefault()});b("a.plupload_stop",d).click(function(b){b.preventDefault();a.stop()});b("a.plupload_start",d).addClass("plupload_disabled")});a.bind("Error",function(f,e){var k=e.file,h;k&&(h=e.message,e.details&&(h+=" ("+e.details+")"),e.code==plupload.FILE_SIZE_ERROR&&alert(c("Error: File too large:")+" "+k.name),e.code==plupload.FILE_EXTENSION_ERROR&&alert(c("Error: Invalid file extension:")+" "+k.name),k.hint=h,b("#"+k.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",h));e.code===plupload.INIT_ERROR&&setTimeout(function(){delete m[g];a.destroy();d.html(n);a=d=n=null},1)});a.bind("PostInit",function(a){a.settings.dragdrop&&a.features.dragdrop&&b("#"+g+"_filelist").append('\x3cli class\x3d"plupload_droptext"\x3e'+c("Drag files here.")+"\x3c/li\x3e")});a.init();a.bind("StateChanged",function(){a.state===plupload.STARTED?(b("li.plupload_delete a,div.plupload_buttons",d).hide(),b("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",d).css("display","block"),b("span.plupload_upload_status",d).html("Uploaded "+a.total.uploaded+"/"+a.files.length+" files"),f.multiple_queues&&b("span.plupload_total_status,span.plupload_total_file_size",d).show()):(l(),b("a.plupload_stop,div.plupload_progress",d).hide(),b("a.plupload_delete",d).css("display","block"),f.multiple_queues&&a.total.uploaded+a.total.failed==a.files.length&&(b(".plupload_buttons,.plupload_upload_status",d).css("display","inline"),b(".plupload_start",d).addClass("plupload_disabled"),b("span.plupload_total_status,span.plupload_total_file_size",d).hide()))});a.bind("FilesAdded",l);a.bind("FilesRemoved",function(){var a=b("#"+g+"_filelist").scrollTop();l();b("#"+g+"_filelist").scrollTop(a)});a.bind("FileUploaded",function(a,b){h(b)});a.bind("UploadProgress",function(a,c){b("#"+c.id+" div.plupload_file_status",d).html(c.percent+"%");h(c);p()});f.setup&&f.setup(a)}),this):m[b(this[0]).attr("id")]}})(jQuery);