(function(A,B){function R(f,h){for(var c,a=[],b=0;b<f.length;++b){if(!(c=C[f[b]]))a:{c=A;for(var g=f[b].split(/[.\/]/),d=0;d<g.length;++d){if(!c[g[d]]){c=void 0;break a}c=c[g[d]]}}if(!c)throw"module definition dependecy not found: "+f[b];a.push(c)}h.apply(null,a)}function p(f,h,c){if("string"!==typeof f)throw"invalid module definition, module id must be defined and be a string";if(h===B)throw"invalid module definition, dependencies must be specified";if(c===B)throw"invalid module definition, definition function must be specified";R(h,function(){C[f]=c.apply(null,arguments)})}var C={};p("moxie/core/utils/Basic",[],function(){var f=function(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},h=function(b){c(arguments,function(g,d){0<d&&c(g,function(d,k){void 0!==d&&(f(b[k])===f(d)&&~a(f(d),["array","object"])?h(b[k],d):b[k]=d)})});return b},c=function(a,c){var b,g;if(a){try{b=a.length}catch(k){b=void 0}if(void 0===b)for(g in a){if(a.hasOwnProperty(g)&&!1===c(a[g],g))break}else for(g=0;g<b&&!1!==c(a[g],g);g++);}},a=function(a,g){if(g){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(g,a);for(var b=0,c=g.length;b<c;b++)if(g[b]===a)return b}return-1};return{guid:function(){var a=0;return function(b){var d=(new Date).getTime().toString(32),c;for(c=0;5>c;c++)d+=Math.floor(65535*Math.random()).toString(32);return(b||"o_")+d+(a++).toString(32)}}(),typeOf:f,extend:h,each:c,isEmptyObj:function(a){var b;if(!a||"object"!==f(a))return!0;for(b in a)return!1;return!0},inSeries:function(a,c){function b(d){if("function"===f(a[d]))a[d](function(a){++d<g&&!a?b(d):c(a)})}var g=a.length;"function"!==f(c)&&(c=function(){});a&&a.length||c();b(0)},inArray:a,arrayDiff:function(b,c){var d=[];"array"!==f(b)&&(b=[b]);"array"!==f(c)&&(c=[c]);for(var g in b)-1===a(b[g],c)&&d.push(b[g]);return d.length?d:!1},arrayIntersect:function(b,g){var d=[];c(b,function(b){-1!==a(b,g)&&d.push(b)});return d.length?d:null},toArray:function(a){var b,d=[];for(b=0;b<a.length;b++)d[b]=a[b];return d},trim:function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},parseSizeStr:function(a){if("string"!==typeof a)return a;var b={t:1099511627776,g:1073741824,m:1048576,k:1024},d;a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,""));d=a[2];a=+a[1];b.hasOwnProperty(d)&&(a*=b[d]);return a}}});p("moxie/core/I18n",["moxie/core/utils/Basic"],function(f){var h={};return{addI18n:function(c){return f.extend(h,c)},translate:function(c){return h[c]||c},_:function(c){return this.translate(c)},sprintf:function(c){var a=[].slice.call(arguments,1);return c.replace(/%[a-z]/g,function(){return a.shift()||""})}}});p("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(f,h){var c={mimes:{},extensions:{},addMimeType:function(a){a=a.split(/,/);var b,c,d;for(b=0;b<a.length;b+=2){d=a[b+1].split(/ /);for(c=0;c<d.length;c++)this.mimes[d[c]]=a[b];this.extensions[a[b]]=d}},extList2mimes:function(a,b){var c,d,e,k,q=[];for(d=0;d<a.length;d++)for(c=a[d].extensions.split(/\s*,\s*/),e=0;e<c.length;e++){if("*"===c[e])return[];if(k=this.mimes[c[e]])-1===f.inArray(k,q)&&q.push(k);else if(b&&/^\w+$/.test(c[e]))q.push("."+c[e]);else return[]}return q},mimes2exts:function(a){var b=this,c=[];f.each(a,function(a){if("*"===a)return c=[],!1;var d=a.match(/^(\w+)\/(\*|\w+)$/);d&&("*"===d[2]?f.each(b.extensions,function(a,g){(new RegExp("^"+d[1]+"/")).test(g)&&[].push.apply(c,b.extensions[g])}):b.extensions[a]&&[].push.apply(c,b.extensions[a]))});return c},mimes2extList:function(a){var b=[],c;"string"===f.typeOf(a)&&(a=f.trim(a).split(/\s*,\s*/));c=this.mimes2exts(a);b.push({title:h.translate("Files"),extensions:c.length?c.join(","):"*"});b.mimes=a;return b},getFileExtension:function(a){return(a=a&&a.match(/\.([^.]+)$/))?a[1].toLowerCase():""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};c.addMimeType("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");return c});p("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(f){var h=function(a){var b={has:function(a,b){return-1!==b.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},c=function(){for(var b,d=0,c,k,g,e,l,f=arguments;d<f.length;d+=2){l=f[d];var q=f[d+1];if("undefined"===typeof b)for(g in b={},q)c=q[g],"object"===typeof c?b[c[0]]=a:b[c]=a;for(c=k=0;c<l.length;c++)if(e=l[c].exec(this.getUA())){for(g=0;g<q.length;g++)l=e[++k],c=q[g],"object"===typeof c&&0<c.length?2==c.length?b[c[0]]="function"==typeof c[1]?c[1].call(this,l):c[1]:3==c.length?b[c[0]]="function"!==typeof c[1]||c[1].exec&&c[1].test?l?l.replace(c[1],c[2]):a:l?c[1].call(this,l,c[2]):a:4==c.length&&(b[c[0]]=l?c[3].call(this,l.replace(c[1],c[2])):a):b[c]=l?l:a;break}if(e)break}return b},d=function(c,d){for(var k in d)if("object"===typeof d[k]&&0<d[k].length)for(var g=0;g<d[k].length;g++){if(b.has(d[k][g],c))return"?"===k?a:k}else if(b.has(d[k],c))return"?"===k?a:k;return c},e={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"},k=[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],["name","version","major"],[/\s(opr)\/((\d+)?[\w\.]+)/i],[["name","Opera"],"version","major"],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],["name","version","major"],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[["name","IE"],"version","major"],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[["name","Yandex"],"version","major"],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[["name",/_/g," "],"version","major"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],["name","version","major"],[/(dolfin)\/((\d+)?[\w\.]+)/i],[["name","Dolphin"],"version","major"],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[["name","Chrome"],"version","major"],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[["name","Android Browser"],"version","major"],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],["version","major",["name","Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],["version","major","name"],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],["name",["major",d,{1:["/8","/1","/3"],2:"/4","?":"/"}],["version",d,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],["name","version","major"],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[["name","Netscape"],"version","major"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],["name","version","major"]],f=[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],["version","name"]],l=[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",d,e]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",d,e]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name","Symbian"],"version"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],["name",["version",/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]];return(new function(a){var b=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"");this.getBrowser=function(){return c.apply(this,k)};this.getEngine=function(){return c.apply(this,f)};this.getOS=function(){return c.apply(this,l)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return b};this.setUA=function(a){b=a;return this};this.setUA(b)}).getResult()}(),c={can:function(){var a={define_property:!1,create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(a){try{if(-1!==f.inArray(a,["","text","document"]))return!0;if(window.XMLHttpRequest){var b=new XMLHttpRequest;b.open("get","/");if("responseType"in b)return b.responseType=a,b.responseType!==a?!1:!0}}catch(d){}return!1},use_data_uri:function(){var b=new Image;b.onload=function(){a.use_data_uri=1===b.width&&1===b.height};setTimeout(function(){b.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw\x3d\x3d"},1);return!1}(),use_data_uri_over32kb:function(){return a.use_data_uri&&("IE"!==c.browser||9<=c.version)},use_data_uri_of:function(b){return a.use_data_uri&&33E3>b||a.use_data_uri_over32kb()},use_fileinput:function(){var a=document.createElement("input");a.setAttribute("type","file");return!a.disabled}};return function(b){var c=[].slice.call(arguments);c.shift();return"function"===f.typeOf(a[b])?a[b].apply(this,c):!!a[b]}}(),browser:h.browser.name,version:parseFloat(h.browser.major),os:h.os.name,osVersion:h.os.version,verComp:function(a,b,c){var d=0,e=0,k=0,g={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},d=function(a){a=(""+a).replace(/[_\-+]/g,".");a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return a.length?a.split("."):[-8]},l=function(a){return a?isNaN(a)?g[a]||-7:parseInt(a,10):0};a=d(a);b=d(b);e=Math.max(a.length,b.length);for(d=0;d<e;d++)if(a[d]!=b[d])if(a[d]=l(a[d]),b[d]=l(b[d]),a[d]<b[d]){k=-1;break}else if(a[d]>b[d]){k=1;break}if(!c)return k;switch(c){case "\x3e":case "gt":return 0<k;case "\x3e\x3d":case "ge":return 0<=k;case "\x3c\x3d":case "le":return 0>=k;case "\x3d\x3d":case "\x3d":case "eq":return 0===k;case "\x3c\x3e":case "!\x3d":case "ne":return 0!==k;case "":case "\x3c":case "lt":return 0>k;default:return null}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};c.OS=c.os;return c});p("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(f){var h=function(c,a){return c.className?(new RegExp("(^|\\s+)"+a+"(\\s+|$)")).test(c.className):!1};return{get:function(c){return"string"!==typeof c?c:document.getElementById(c)},hasClass:h,addClass:function(c,a){h(c,a)||(c.className=c.className?c.className.replace(/\s+$/,"")+" "+a:a)},removeClass:function(c,a){c.className&&(c.className=c.className.replace(new RegExp("(^|\\s+)"+a+"(\\s+|$)"),function(a,c,d){return" "===c&&" "===d?" ":""}))},getStyle:function(c,a){if(c.currentStyle)return c.currentStyle[a];if(window.getComputedStyle)return window.getComputedStyle(c,null)[a]},getPos:function(c,a){function b(a){var b,c=0;b=0;a&&(b=a.getBoundingClientRect(),a="CSS1Compat"===k.compatMode?k.documentElement:k.body,c=b.left+a.scrollLeft,b=b.top+a.scrollTop);return{x:c,y:b}}var g=0,d=0,e,k=document;a=a||k.body;if(c&&c.getBoundingClientRect&&"IE"===f.browser&&(!k.documentMode||8>k.documentMode))return g=b(c),d=b(a),{x:g.x-d.x,y:g.y-d.y};for(e=c;e&&e!=a&&e.nodeType;)g+=e.offsetLeft||0,d+=e.offsetTop||0,e=e.offsetParent;for(e=c.parentNode;e&&e!=a&&e.nodeType;)g-=e.scrollLeft||0,d-=e.scrollTop||0,e=e.parentNode;return{x:g,y:d}},getSize:function(c){return{w:c.offsetWidth||c.clientWidth,h:c.offsetHeight||c.clientHeight}}}});p("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(f){function h(c,a){for(var b in c)if(c[b]===a)return b;return null}return{RuntimeError:function(){function c(b){this.code=b;this.name=h(a,b);this.message=this.name+": RuntimeError "+this.code}var a={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};f.extend(c,a);c.prototype=Error.prototype;return c}(),OperationNotAllowedException:function(){function c(a){this.code=a;this.name="OperationNotAllowedException"}f.extend(c,{NOT_ALLOWED_ERR:1});c.prototype=Error.prototype;return c}(),ImageError:function(){function c(b){this.code=b;this.name=h(a,b);this.message=this.name+": ImageError "+this.code}var a={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};f.extend(c,a);c.prototype=Error.prototype;return c}(),FileException:function(){function c(b){this.code=b;this.name=h(a,b);this.message=this.name+": FileException "+this.code}var a={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};f.extend(c,a);c.prototype=Error.prototype;return c}(),DOMException:function(){function c(b){this.code=b;this.name=h(a,b);this.message=this.name+": DOMException "+this.code}var a={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};f.extend(c,a);c.prototype=Error.prototype;return c}(),EventException:function(){function c(a){this.code=a;this.name="EventException"}f.extend(c,{UNSPECIFIED_EVENT_TYPE_ERR:0});c.prototype=Error.prototype;return c}()}});p("moxie/core/EventTarget",["moxie/core/Exceptions","moxie/core/utils/Basic"],function(f,h){function c(){var a={};h.extend(this,{uid:null,init:function(){this.uid||(this.uid=h.guid("uid_"))},addEventListener:function(b,c,d,e){var k=this,g;b=h.trim(b);/\s/.test(b)?h.each(b.split(/\s+/),function(a){k.addEventListener(a,c,d,e)}):(b=b.toLowerCase(),d=parseInt(d,10)||0,g=a[this.uid]&&a[this.uid][b]||[],g.push({fn:c,priority:d,scope:e||this}),a[this.uid]||(a[this.uid]={}),a[this.uid][b]=g)},hasEventListener:function(b){return b?!(!a[this.uid]||!a[this.uid][b]):!!a[this.uid]},removeEventListener:function(b,c){b=b.toLowerCase();var d=a[this.uid]&&a[this.uid][b],e;if(d){if(c)for(e=d.length-1;0<=e;e--){if(d[e].fn===c){d.splice(e,1);break}}else d=[];d.length||(delete a[this.uid][b],h.isEmptyObj(a[this.uid])&&delete a[this.uid])}},removeAllEventListeners:function(){a[this.uid]&&delete a[this.uid]},dispatchEvent:function(b){var c,d,e,k={},q=!0;if("string"!==h.typeOf(b))if(d=b,"string"===h.typeOf(d.type))b=d.type,void 0!==d.total&&void 0!==d.loaded&&(k.total=d.total,k.loaded=d.loaded),k.async=d.async||!1;else throw new f.EventException(f.EventException.UNSPECIFIED_EVENT_TYPE_ERR);-1!==b.indexOf("::")?function(a){c=a[0];b=a[1]}(b.split("::")):c=this.uid;b=b.toLowerCase();if(d=a[c]&&a[c][b]){d.sort(function(a,b){return b.priority-a.priority});e=[].slice.call(arguments);e.shift();k.type=b;e.unshift(k);var l=[];h.each(d,function(a){e[0].target=a.scope;k.async?l.push(function(b){setTimeout(function(){b(!1===a.fn.apply(a.scope,e))},1)}):l.push(function(b){b(!1===a.fn.apply(a.scope,e))})});l.length&&h.inSeries(l,function(a){q=!a})}return q},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(a){var b;"array"!==h.typeOf(a)&&(a=[a]);for(var c=0;c<a.length;c++)b="on"+a[c],"function"===h.typeOf(this[b])?this.addEventListener(a[c],this[b]):"undefined"===h.typeOf(this[b])&&(this[b]=null)}})}c.instance=new c;return c});p("moxie/core/utils/Encode",[],function(){var f=function(c){return unescape(encodeURIComponent(c))},h=function(c){return decodeURIComponent(escape(c))};return{utf8_encode:f,utf8_decode:h,atob:function(c,a){if("function"===typeof window.atob)return a?h(window.atob(c)):window.atob(c);var b,g,d,e,k,f=0,l=0,n=[];if(!c)return c;c+="";do b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(c.charAt(f++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(c.charAt(f++)),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(c.charAt(f++)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(c.charAt(f++)),d=b<<18|g<<12|e<<6|k,b=d>>16&255,g=d>>8&255,d&=255,64==e?n[l++]=String.fromCharCode(b):64==k?n[l++]=String.fromCharCode(b,g):n[l++]=String.fromCharCode(b,g,d);while(f<c.length);e=n.join("");return a?h(e):e},btoa:function(c,a){a&&f(c);if("function"===typeof window.btoa)return window.btoa(c);var b,g,d,e,k=0,h=0,l=[];if(!c)return c;do b=c.charCodeAt(k++),g=c.charCodeAt(k++),d=c.charCodeAt(k++),e=b<<16|g<<8|d,b=e>>18&63,g=e>>12&63,d=e>>6&63,e&=63,l[h++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(e);while(k<c.length);k=l.join("");h=c.length%3;return(h?k.slice(0,h-3):k)+"\x3d\x3d\x3d".slice(h||3)}}});p("moxie/runtime/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(f,h,c){function a(b,c,k,q,l){var d=this,e,m=f.guid(c+"_");l=l||"browser";b=b||{};g[m]=this;k=f.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},k);b.preferred_caps&&(l=a.getMode(q,b.preferred_caps,l));e=function(){var a={};return{exec:function(b,c,d,k){if(e[c]&&(a[b]||(a[b]={context:this,instance:new e[c]}),a[b].instance[d]))return a[b].instance[d].apply(this,k)},removeInstance:function(b){delete a[b]},removeAllInstances:function(){var b=this;f.each(a,function(a,c){"function"===f.typeOf(a.instance.destroy)&&a.instance.destroy.call(a.context);b.removeInstance(c)})}}}();f.extend(this,{initialized:!1,uid:m,type:c,mode:a.getMode(q,b.required_caps,l),shimid:m+"_container",clients:0,options:b,can:function(b,c,d){d=d||k;"string"===f.typeOf(b)&&"undefined"===f.typeOf(c)&&(b=a.parseCaps(b));if("object"===f.typeOf(b)){for(var e in b)if(!this.can(e,b[e],d))return!1;return!0}return"function"===f.typeOf(d[b])?d[b].call(this,c):c===d[b]},getShimContainer:function(){var a,b=h.get(this.shimid);b||(a=this.options.container?h.get(this.options.container):document.body,b=document.createElement("div"),b.id=this.shimid,b.className="moxie-shim moxie-shim-"+this.type,f.extend(b.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),a.appendChild(b));return b},getShim:function(){return e},shimExec:function(a,b){var c=[].slice.call(arguments,2);return d.getShim().exec.call(this,this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,2);return d[a]&&d[a][b]?d[a][b].apply(this,c):d.shimExec.apply(this,arguments)},destroy:function(){if(d){var a=h.get(this.shimid);a&&a.parentNode.removeChild(a);e&&e.removeAllInstances();this.unbindAll();delete g[this.uid];m=d=e=this.uid=null}}});this.mode&&b.required_caps&&!this.can(b.required_caps)&&(this.mode=!1)}var b={},g={};a.order="html5,flash,silverlight,html4";a.getRuntime=function(a){return g[a]?g[a]:!1};a.addConstructor=function(a,e){e.prototype=c.instance;b[a]=e};a.getConstructor=function(a){return b[a]||null};a.getInfo=function(b){var c=a.getRuntime(b);return c?{uid:c.uid,type:c.type,mode:c.mode,can:function(){return c.can.apply(c,arguments)}}:null};a.parseCaps=function(a){var b={};if("string"!==f.typeOf(a))return a||{};f.each(a.split(","),function(a){b[a]=!0});return b};a.can=function(b,c){var d;d=a.getConstructor(b);var e;return d?(d=new d({required_caps:c}),e=d.mode,d.destroy(),!!e):!1};a.thatCan=function(b,c){var d=(c||a.order).split(/\s*,\s*/),e;for(e in d)if(a.can(d[e],b))return d[e];return null};a.getMode=function(a,b,c){var d=null;"undefined"===f.typeOf(c)&&(c="browser");if(b&&!f.isEmptyObj(a)){f.each(b,function(b,c){if(a.hasOwnProperty(c)){var k=a[c](b);"string"===typeof k&&(k=[k]);if(!d)d=k;else if(!(d=f.arrayIntersect(d,k)))return d=!1}});if(d)return-1!==f.inArray(c,d)?c:d[0];if(!1===d)return!1}return c};a.capTrue=function(){return!0};a.capFalse=function(){return!1};a.capTest=function(a){return function(){return!!a}};return a});p("moxie/runtime/RuntimeClient",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(f,h,c){return function(){var a;h.extend(this,{connectRuntime:function(b){function g(k){var e;k.length?(e=k.shift(),(e=c.getConstructor(e))?(a=new e(b),a.bind("Init",function(){a.initialized=!0;setTimeout(function(){a.clients++;d.trigger("RuntimeInit",a)},1)}),a.bind("Error",function(){a.destroy();g(k)}),a.mode?a.init():a.trigger("Error")):g(k)):(d.trigger("RuntimeError",new f.RuntimeError(f.RuntimeError.NOT_INIT_ERR)),a=null)}var d=this,e;"string"===h.typeOf(b)?e=b:"string"===h.typeOf(b.ruid)&&(e=b.ruid);if(e){if(a=c.getRuntime(e))return a.clients++,a;throw new f.RuntimeError(f.RuntimeError.NOT_INIT_ERR);}g((b.runtime_order||c.order).split(/\s*,\s*/))},getRuntime:function(){return a&&a.uid?a:a=null},disconnectRuntime:function(){a&&0>=--a.clients&&(a.destroy(),a=null)}})}});p("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(f,h,c){function a(g,d){function e(c,d,e){var k=b[this.uid];if("string"!==f.typeOf(k)||!k.length)return null;d=new a(null,{type:e,size:d-c});d.detach(k.substr(c,d.size));return d}c.call(this);g&&this.connectRuntime(g);d?"string"===f.typeOf(d)&&(d={data:d}):d={};f.extend(this,{uid:d.uid||f.guid("uid_"),ruid:g,size:d.size||0,type:d.type||"",slice:function(a,b,c){return this.isDetached()?e.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,b,c)},getSource:function(){return b[this.uid]?b[this.uid]:null},detach:function(a){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy",b[this.uid]),this.disconnectRuntime(),this.ruid=null);a=a||"";var c=a.match(/^data:([^;]*);base64,/);c&&(this.type=c[1],a=h.atob(a.substring(a.indexOf("base64,")+7)));this.size=a.length;b[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===f.typeOf(b[this.uid])},destroy:function(){this.detach();delete b[this.uid]}});d.data?this.detach(d.data):b[this.uid]=d}var b={};return a});p("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(f,h,c){function a(a,g){var b,e;g||(g={});e=g.type&&""!==g.type?g.type:h.getFileMime(g.name);g.name?(b=g.name.replace(/\\/g,"/"),b=b.substr(b.lastIndexOf("/")+1)):(b=e.split("/")[0],b=f.guid((""!==b?b:"file")+"_"),h.extensions[e]&&(b+="."+h.extensions[e][0]));c.apply(this,arguments);f.extend(this,{type:e||"",name:b||f.guid("file_"),lastModifiedDate:g.lastModifiedDate||(new Date).toLocaleString()})}a.prototype=c.prototype;return a});p("moxie/file/FileInput","moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/file/File moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),function(f,h,c,a,b,g,d,e,k){function q(b){var n=this,m;-1!==f.inArray(f.typeOf(b),["string","node"])&&(b={browse_button:b});m=c.get(b.browse_button);if(!m)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR);m={accept:[{title:g.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:m.parentNode||document.body};b=f.extend({},m,b);"string"===typeof b.required_caps&&(b.required_caps=e.parseCaps(b.required_caps));"string"===typeof b.accept&&(b.accept=h.mimes2extList(b.accept));m=c.get(b.container);m||(m=document.body);"static"===c.getStyle(m,"position")&&(m.style.position="relative");m=m=null;k.call(n);f.extend(n,{uid:f.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){n.convertEventPropsToHandlers(l);n.bind("RuntimeInit",function(a,k){n.ruid=k.uid;n.shimid=k.shimid;n.bind("Ready",function(){n.trigger("Refresh")},999);n.bind("Change",function(){var a=k.exec.call(n,"FileInput","getFiles");n.files=[];f.each(a,function(a){if(0===a.size)return!0;n.files.push(new d(n.ruid,a))})},999);n.bind("Refresh",function(){var a,d,e;d=c.get(b.browse_button);e=c.get(k.shimid);d&&(a=c.getPos(d,c.get(b.container)),d=c.getSize(d),e&&f.extend(e.style,{top:a.y+"px",left:a.x+"px",width:d.w+"px",height:d.h+"px"}))});k.exec.call(n,"FileInput","init",b)});n.connectRuntime(f.extend({},b,{required_caps:{select_file:!0}}))},disable:function(a){var b=this.getRuntime();b&&b.exec.call(this,"FileInput","disable","undefined"===f.typeOf(a)?!0:a)},refresh:function(){n.trigger("Refresh")},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileInput","destroy"),this.disconnectRuntime());"array"===f.typeOf(this.files)&&f.each(this.files,function(a){a.destroy()});this.files=null}})}var l="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");q.prototype=b.instance;return q});p("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),function(f,h,c,a,b,g,d,e){function k(c){var d=this,k;"string"===typeof c&&(c={drop_zone:c});k={accept:[{title:f.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};c="object"===typeof c?a.extend({},k,c):k;c.container=h.get(c.drop_zone)||document.body;"static"===h.getStyle(c.container,"position")&&(c.container.style.position="relative");"string"===typeof c.accept&&(c.accept=e.mimes2extList(c.accept));g.call(d);a.extend(d,{uid:a.guid("uid_"),ruid:null,files:null,init:function(){d.convertEventPropsToHandlers(q);d.bind("RuntimeInit",function(k,e){d.ruid=e.uid;d.bind("Drop",function(){var c=e.exec.call(d,"FileDrop","getFiles");d.files=[];a.each(c,function(a){d.files.push(new b(d.ruid,a))})},999);e.exec.call(d,"FileDrop","init",c);d.dispatchEvent("ready")});d.connectRuntime(c)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());this.files=null}})}var q=["ready","dragenter","dragleave","drop","error"];k.prototype=d.instance;return k});p("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(f,h,c){function a(){this.uid=f.guid("uid_");h.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}a.prototype=c.instance;return a});p("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/runtime/RuntimeTarget".split(" "),function(f,h,c,a,b,g,d){function e(){function a(a,f){function l(a){g.readyState=e.DONE;g.error=a;g.trigger("error");q()}function q(){n.destroy();n=null;g.trigger("loadend")}function m(b){n.bind("Error",function(a,b){l(b)});n.bind("Progress",function(a){g.result=b.exec.call(n,"FileReader","getResult");g.trigger(a)});n.bind("Load",function(a){g.readyState=e.DONE;g.result=b.exec.call(n,"FileReader","getResult");g.trigger(a);q()});b.exec.call(n,"FileReader","read",a,f)}n=new d;this.convertEventPropsToHandlers(k);if(this.readyState===e.LOADING)return l(new c.DOMException(c.DOMException.INVALID_STATE_ERR));this.readyState=e.LOADING;this.trigger("loadstart");if(f instanceof b)if(f.isDetached()){var t=f.getSource();switch(a){case "readAsText":case "readAsBinaryString":this.result=t;break;case "readAsDataURL":this.result="data:"+f.type+";base64,"+h.btoa(t)}this.readyState=e.DONE;this.trigger("load");q()}else m(n.connectRuntime(f.ruid));else l(new c.DOMException(c.DOMException.NOT_FOUND_ERR))}var g=this,n;f.extend(this,{uid:f.guid("uid_"),readyState:e.EMPTY,result:null,error:null,readAsBinaryString:function(b){a.call(this,"readAsBinaryString",b)},readAsDataURL:function(b){a.call(this,"readAsDataURL",b)},readAsText:function(b){a.call(this,"readAsText",b)},abort:function(){this.result=null;-1===f.inArray(this.readyState,[e.EMPTY,e.DONE])&&(this.readyState===e.LOADING&&(this.readyState=e.DONE),n&&n.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();n&&(n.getRuntime().exec.call(this,"FileReader","destroy"),n.disconnectRuntime());g=n=null}})}var k="loadstart progress load abort error loadend".split(" ");e.EMPTY=0;e.LOADING=1;e.DONE=2;e.prototype=a.instance;return e});p("moxie/core/utils/Url",[],function(){var f=function(h,c){for(var a="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),b=a.length,g={http:80,https:443},d={},e=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(h||"");b--;)e[b]&&(d[a[b]]=e[b]);d.scheme||(c&&"string"!==typeof c||(c=f(c||document.location.href)),d.scheme=c.scheme,d.host=c.host,d.port=c.port,a="",/^[^\/]/.test(d.path)&&(a=c.path,a=/(\/|\/[^\.]+)$/.test(a)?a+"/":a.replace(/\/[^\/]+$/,"/")),d.path=a+(d.path||""));d.port||(d.port=g[d.scheme]||80);d.port=parseInt(d.port,10);d.path||(d.path="/");delete d.source;return d};return{parseUrl:f,resolveUrl:function(h){h=f(h);return h.scheme+"://"+h.host+(h.port!=={http:80,https:443}[h.scheme]?":"+h.port:"")+h.path+(h.query?h.query:"")},hasSameOrigin:function(h){function c(a){return[a.scheme,a.host,a.port].join("/")}"string"===typeof h&&(h=f(h));return c(f())===c(h)}}});p("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(f,h,c){return function(){function a(a,g){if(g.isDetached()){var b=g.getSource();switch(a){case "readAsBinaryString":return b;case "readAsDataURL":return"data:"+g.type+";base64,"+c.btoa(b);case "readAsText":for(var e="",k=0,f=b.length;k<f;k++)e+=String.fromCharCode(b[k]);return e}}else return b=this.connectRuntime(g.ruid).exec.call(this,"FileReaderSync","read",a,g),this.disconnectRuntime(),b}h.call(this);f.extend(this,{uid:f.guid("uid_"),readAsBinaryString:function(b){return a.call(this,"readAsBinaryString",b)},readAsDataURL:function(b){return a.call(this,"readAsDataURL",b)},readAsText:function(b){return a.call(this,"readAsText",b)}})}});p("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(f,h,c){return function(){var a,b=[];h.extend(this,{append:function(g,d){var e=this,k=h.typeOf(d);d instanceof c?a={name:g,value:d}:"array"===k?(g+="[]",h.each(d,function(a){e.append(g,a)})):"object"===k?h.each(d,function(a,b){e.append(g+"["+b+"]",a)}):"null"===k||"undefined"===k||"number"===k&&isNaN(d)?e.append(g,"false"):b.push({name:g,value:d.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return a&&a.value||null},getBlobName:function(){return a&&a.name||null},each:function(c){h.each(b,function(a){c(a.value,a.name)});a&&c(a.value,a.name)},destroy:function(){a=null;b=[]}})}});p("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),function(f,h,c,a,b,g,d,e,k,q,l,n){function t(){this.uid=f.guid("uid_")}function m(){function c(a,b){if(x.hasOwnProperty(a)){if(1===arguments.length)return l.can("define_property")?x[a]:w[a];l.can("define_property")?x[a]=b:w[a]=b}}function k(a){function b(){y.destroy();y=null;e.dispatchEvent("loadend");e=null}function k(d){y.bind("LoadStart",function(a){c("readyState",m.LOADING);e.dispatchEvent("readystatechange");e.dispatchEvent(a);K&&e.upload.dispatchEvent(a)});y.bind("Progress",function(a){c("readyState")!==m.LOADING&&(c("readyState",m.LOADING),e.dispatchEvent("readystatechange"));e.dispatchEvent(a)});y.bind("UploadProgress",function(a){K&&e.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})});y.bind("Load",function(a){c("readyState",m.DONE);c("status",Number(d.exec.call(y,"XMLHttpRequest","getStatus")||0));c("statusText",D[c("status")]||"");c("response",d.exec.call(y,"XMLHttpRequest","getResponse",c("responseType")));~f.inArray(c("responseType"),["text",""])?c("responseText",c("response")):"document"===c("responseType")&&c("responseXML",c("response"));B=d.exec.call(y,"XMLHttpRequest","getAllResponseHeaders");e.dispatchEvent("readystatechange");0<c("status")?(K&&e.upload.dispatchEvent(a),e.dispatchEvent(a)):(H=!0,e.dispatchEvent("error"));b()});y.bind("Abort",function(a){e.dispatchEvent(a);b()});y.bind("Error",function(a){H=!0;c("readyState",m.DONE);e.dispatchEvent("readystatechange");L=!0;e.dispatchEvent(a);b()});d.exec.call(y,"XMLHttpRequest","send",{url:F,method:I,async:p,user:P,password:Q,headers:G,mimeType:M,encoding:N,responseType:e.responseType,withCredentials:e.withCredentials,options:z},a)}var e=this;(new Date).getTime();y=new d;"string"===typeof z.required_caps&&(z.required_caps=g.parseCaps(z.required_caps));z.required_caps=f.extend({},z.required_caps,{return_response_type:e.responseType});a instanceof q&&(z.required_caps.send_multipart=!0);A||(z.required_caps.do_cors=!0);z.ruid?k(y.connectRuntime(z)):(y.bind("RuntimeInit",function(a,b){k(b)}),y.bind("RuntimeError",function(a,b){e.dispatchEvent("RuntimeError",b)}),y.connectRuntime(z))}var w=this,x={timeout:0,readyState:m.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},p=!0,F,I,G={},P,Q,N=null,M=null,O=!1,J=!1,K=!1,L=!1,H=!1,A=!1,z={},y,B="",C;f.extend(this,x,{uid:f.guid("uid_"),upload:new t,open:function(d,k,e,g,l){if(!d||!k)throw new h.DOMException(h.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(d)||a.utf8_encode(d)!==d)throw new h.DOMException(h.DOMException.SYNTAX_ERR);~f.inArray(d.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&(I=d.toUpperCase());if(~f.inArray(I,["CONNECT","TRACE","TRACK"]))throw new h.DOMException(h.DOMException.SECURITY_ERR);k=a.utf8_encode(k);d=b.parseUrl(k);A=b.hasSameOrigin(d);F=b.resolveUrl(k);if((g||l)&&!A)throw new h.DOMException(h.DOMException.INVALID_ACCESS_ERR);P=g||d.user;Q=l||d.pass;p=e||!0;if(!1===p&&(c("timeout")||c("withCredentials")||""!==c("responseType")))throw new h.DOMException(h.DOMException.INVALID_ACCESS_ERR);O=!p;J=!1;G={};c("responseText","");c("responseXML",null);c("response",null);c("status",0);c("statusText","");c("readyState",m.OPENED);this.convertEventPropsToHandlers(["readystatechange"]);this.dispatchEvent("readystatechange")},setRequestHeader:function(b,d){if(c("readyState")!==m.OPENED||J)throw new h.DOMException(h.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(b)||a.utf8_encode(b)!==b)throw new h.DOMException(h.DOMException.SYNTAX_ERR);b=f.trim(b).toLowerCase();if(~f.inArray(b,"accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||/^(proxy\-|sec\-)/.test(b))return!1;G[b]=G[b]?G[b]+(", "+d):d;return!0},getAllResponseHeaders:function(){return B||""},getResponseHeader:function(a){a=a.toLowerCase();return H||~f.inArray(a,["set-cookie","set-cookie2"])?null:B&&""!==B&&(C||(C={},f.each(B.split(/\r\n/),function(a){a=a.split(/:\s+/);2===a.length&&(a[0]=f.trim(a[0]),C[a[0].toLowerCase()]={header:a[0],value:f.trim(a[1])})})),C.hasOwnProperty(a))?C[a].header+": "+C[a].value:null},overrideMimeType:function(a){var b;if(~f.inArray(c("readyState"),[m.LOADING,m.DONE]))throw new h.DOMException(h.DOMException.INVALID_STATE_ERR);a=f.trim(a.toLowerCase());/;/.test(a)&&(b=a.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(a=b[1]);if(!n.mimes[a])throw new h.DOMException(h.DOMException.SYNTAX_ERR);},send:function(b,c){z="string"===f.typeOf(c)?{ruid:c}:c?c:{};this.convertEventPropsToHandlers(r);this.upload.convertEventPropsToHandlers(r);if(this.readyState!==m.OPENED||J)throw new h.DOMException(h.DOMException.INVALID_STATE_ERR);if(b instanceof e)z.ruid=b.ruid,M=b.type||"application/octet-stream";else if(b instanceof q){if(b.hasBlob()){var d=b.getBlob();z.ruid=d.ruid;M=d.type||"application/octet-stream"}}else"string"===typeof b&&(N="UTF-8",M="text/plain;charset\x3dUTF-8",b=a.utf8_encode(b));this.withCredentials||(this.withCredentials=z.required_caps&&z.required_caps.send_browser_cookies&&!A);K=!O&&this.upload.hasEventListener();H=!1;L=!b;O||(J=!0);k.call(this,b)},abort:function(){H=!0;O=!1;if(~f.inArray(c("readyState"),[m.UNSENT,m.OPENED,m.DONE]))c("readyState",m.UNSENT);else{c("readyState",m.DONE);J=!1;if(y)y.getRuntime().exec.call(y,"XMLHttpRequest","abort",L);else throw new h.DOMException(h.DOMException.INVALID_STATE_ERR);L=!0}},destroy:function(){y&&("function"===f.typeOf(y.destroy)&&y.destroy(),y=null);this.unbindAll();this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var D={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};t.prototype=c.instance;var r="loadstart progress abort error load timeout loadend".split(" ");m.UNSENT=0;m.OPENED=1;m.HEADERS_RECEIVED=2;m.LOADING=3;m.DONE=4;m.prototype=c.instance;return m});p("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(f,h,c,a){function b(){function a(a,c){var e=this;k=c;e.bind("TransportingProgress",function(a){n=a.loaded;n<l&&-1===f.inArray(e.state,[b.IDLE,b.DONE])&&d.call(e)},999);e.bind("TransportingComplete",function(){n=l;e.state=b.DONE;q=null;e.result=k.exec.call(e,"Transporter","getAsBlob",a||"")},999);e.state=b.BUSY;e.trigger("TransportingStarted");d.call(e)}function d(){var a;a=l-n;t>a&&(t=a);a=h.btoa(q.substr(n,t));k.exec.call(this,"Transporter","receive",a,l)}var e,k,q,l,n,t;c.call(this);f.extend(this,{uid:f.guid("uid_"),state:b.IDLE,result:null,transport:function(b,c,d){var k=this;d=f.extend({chunk_size:204798},d);if(e=d.chunk_size%3)d.chunk_size+=3-e;t=d.chunk_size;l=n=0;q=this.result=null;q=b;l=b.length;if("string"===f.typeOf(d)||d.ruid)a.call(k,c,this.connectRuntime(d));else{var g=function(b,d){k.unbind("RuntimeInit",g);a.call(k,c,d)};this.bind("RuntimeInit",g);this.connectRuntime(d)}},abort:function(){this.state=b.IDLE;k&&(k.exec.call(this,"Transporter","clear"),this.trigger("TransportingAborted"));l=n=0;q=this.result=null},destroy:function(){this.unbindAll();k=null;this.disconnectRuntime();l=n=0;q=this.result=null}})}b.IDLE=0;b.BUSY=1;b.DONE=2;b.prototype=a.instance;return b});p("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode".split(" "),function(f,h,c,a,b,g,d,e,k,q,l,n,t){function m(){function a(b){var d=f.typeOf(b);try{if(b instanceof m){if(!b.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);q.apply(this,arguments)}else if(b instanceof l){if(!~f.inArray(b.type,["image/jpeg","image/png"]))throw new c.ImageError(c.ImageError.WRONG_FORMAT);v.apply(this,arguments)}else if(-1!==f.inArray(d,["blob","file"]))a.call(this,new n(null,b),arguments[1]);else if("string"===d)/^data:[^;]*;base64,/.test(b)?a.call(this,new l(null,{data:b}),arguments[1]):w.apply(this,arguments);else if("node"===d&&"img"===b.nodeName.toLowerCase())a.call(this,b.src,arguments[1]);else throw new c.DOMException(c.DOMException.TYPE_MISMATCH_ERR);}catch(F){this.trigger("error",F)}}function q(a,b){var c=this.connectRuntime(a.ruid);this.ruid=c.uid;c.exec.call(this,"Image","loadFromImage",a,"undefined"===f.typeOf(b)?!0:b)}function v(a,b){function c(b){d.ruid=b.uid;b.exec.call(d,"Image","loadFromBlob",a)}var d=this;d.name=a.name||"";a.isDetached()?(this.bind("RuntimeInit",function(a,b){c(b)}),b&&"string"===typeof b.required_caps&&(b.required_caps=g.parseCaps(b.required_caps)),this.connectRuntime(f.extend({required_caps:{access_image_binary:!0,resize_image:!0}},b))):c(this.connectRuntime(a.ruid))}function w(a,c){var d=this,e;e=new b;e.open("get",a);e.responseType="blob";e.onprogress=function(a){d.trigger(a)};e.onload=function(){v.call(d,e.response,!0)};e.onerror=function(a){d.trigger(a)};e.onloadend=function(){e.destroy()};e.bind("RuntimeError",function(a,b){d.trigger("RuntimeError",b)});e.send(null,c)}d.call(this);f.extend(this,{uid:f.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){var a;a=this.getRuntime().exec.call(this,"Image","getInfo");this.size=a.size;this.width=a.width;this.height=a.height;this.type=a.type;this.meta=a.meta;""===this.name&&(this.name=a.name)},999);this.convertEventPropsToHandlers(D);a.apply(this,arguments)},downsize:function(a,b,d,e){try{if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>m.MAX_RESIZE_WIDTH||this.height>m.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);if(!a&&!b||"undefined"===f.typeOf(d))d=!1;a=a||this.width;b=b||this.height;e="undefined"===f.typeOf(e)?!0:!!e;this.getRuntime().exec.call(this,"Image","downsize",a,b,d,e)}catch(G){this.trigger("error",G)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!k.can("create_canvas"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);return this.connectRuntime(this.ruid).exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);a||(a="image/jpeg");"image/jpeg"!==a||b||(b=90);return this.getRuntime().exec.call(this,"Image","getAsBlob",a,b)},getAsDataURL:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",a,b)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,b);return t.atob(c.substring(c.indexOf("base64,")+7))},embed:function(a,b){function d(){if(k.can("create_canvas")){var b=l.getAsCanvas();if(b){a.appendChild(b);b=null;l.destroy();g.trigger("embedded");return}}b=l.getAsDataURL(n,q);if(!b)throw new c.ImageError(c.ImageError.WRONG_FORMAT);if(k.can("use_data_uri_of",b.length))a.innerHTML='\x3cimg src\x3d"'+b+'" width\x3d"'+l.width+'" height\x3d"'+l.height+'" /\x3e',l.destroy(),g.trigger("embedded");else{var d=new e;d.bind("TransportingComplete",function(){w=g.connectRuntime(this.result.ruid);g.bind("Embedded",function(){f.extend(w.getShimContainer().style,{top:"0px",left:"0px",width:l.width+"px",height:l.height+"px"});w=null},999);w.exec.call(g,"ImageView","display",this.result.uid,D,v);l.destroy()});d.transport(t.atob(b.substring(b.indexOf("base64,")+7)),n,f.extend({},u,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:a}))}}var g=this,l,n,q,r,u=b||{},D=this.width,v=this.height,w;try{if(!(a=h.get(a)))throw new c.DOMException(c.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>m.MAX_RESIZE_WIDTH||this.height>m.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);n=u.type||this.type||"image/jpeg";q=u.quality||90;r="undefined"!==f.typeOf(u.crop)?u.crop:!1;if(u.width)D=u.width,v=u.height||D;else{var p=h.getSize(a);p.w&&p.h&&(D=p.w,v=p.h)}l=new m;l.bind("Resize",function(){d.call(g)});l.bind("Load",function(){l.downsize(D,v,r,!1)});l.clone(this,!1);return l}catch(H){this.trigger("error",H)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.unbindAll()}})}var D=["progress","load","error","resize","embedded"];m.MAX_RESIZE_WIDTH=6500;m.MAX_RESIZE_HEIGHT=6500;m.prototype=q.instance;return m});p("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(f,h,c,a){var b={};c.addConstructor("html5",function(g,d,e){var k=this,h=c.capTest,l=c.capTrue;e=f.extend({access_binary:h(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return k.can("access_binary")&&!!b.Image},display_media:h(a.can("create_canvas")||a.can("use_data_uri_over32kb")),do_cors:h(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:h(function(){var b=document.createElement("div");return("draggable"in b||"ondragstart"in b&&"ondrop"in b)&&("IE"!==a.browser||9<a.version)}()),filter_by_extension:h("Chrome"===a.browser&&28<=a.version||"IE"===a.browser&&10<=a.version),return_response_headers:l,return_response_type:function(b){return"json"===b&&window.JSON?!0:a.can("return_response_type",b)},return_status_code:l,report_upload_progress:h(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return k.can("access_binary")&&a.can("create_canvas")},select_file:function(){return a.can("use_fileinput")&&window.File},select_folder:function(){return k.can("select_file")&&"Chrome"===a.browser&&21<=a.version},select_multiple:function(){return k.can("select_file")&&!("Safari"===a.browser&&"Windows"===a.os)&&!("iOS"===a.os&&a.verComp(a.osVersion,"7.0.4","\x3c"))},send_binary_string:h(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:h(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||k.can("send_binary_string")},slice_blob:h(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return k.can("slice_blob")&&k.can("send_multipart")},summon_file_dialog:h("Firefox"===a.browser&&4<=a.version||"Opera"===a.browser&&12<=a.version||"IE"===a.browser&&10<=a.version||!!~f.inArray(a.browser,["Chrome","Safari"])),upload_filesize:l},e);c.call(this,g,d||"html5",e);f.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(k);a=k=null}}(this.destroy)});f.extend(this.getShim(),b)});return b});p("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(f,h){return f.Blob=function(){function c(a,b,c){var d;if(window.File.prototype.slice)try{return a.slice(),a.slice(b,c)}catch(e){return a.slice(b,c-b)}else return(d=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?d.call(a,b,c):null}this.slice=function(){return new h(this.getRuntime().uid,c.apply(this,arguments))}}});p("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(f){function h(){this.returnValue=!1}function c(){this.cancelBubble=!0}var a={},b="moxie_"+f.guid(),g=function(c,e,k){var d;e=e.toLowerCase();if(c[b]&&a[c[b]]&&a[c[b]][e]){d=a[c[b]][e];for(var g=d.length-1;0<=g;g--)if(d[g].orig===k||d[g].key===k)if(c.removeEventListener?c.removeEventListener(e,d[g].func,!1):c.detachEvent&&c.detachEvent("on"+e,d[g].func),d[g].orig=null,d[g].func=null,d.splice(g,1),void 0!==k)break;d.length||delete a[c[b]][e];if(f.isEmptyObj(a[c[b]])){delete a[c[b]];try{delete c[b]}catch(n){c[b]=void 0}}}};return{addEvent:function(d,e,k,g){var l;e=e.toLowerCase();d.addEventListener?(l=k,d.addEventListener(e,l,!1)):d.attachEvent&&(l=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=h;a.stopPropagation=c;k(a)},d.attachEvent("on"+e,l));d[b]||(d[b]=f.guid());a.hasOwnProperty(d[b])||(a[d[b]]={});d=a[d[b]];d.hasOwnProperty(e)||(d[e]=[]);d[e].push({func:l,orig:k,key:g})},removeEvent:g,removeAllEvents:function(c,e){c&&c[b]&&f.each(a[c[b]],function(a,b){g(c,b,e)})}}});p("moxie/runtime/html5/file/FileInput","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(f,h,c,a,b,g){return f.FileInput=function(){var d=[],e;h.extend(this,{init:function(k){var f=this,l=f.getRuntime(),n,t,m;e=k;d=[];k=e.accept.mimes||b.extList2mimes(e.accept,l.can("filter_by_extension"));n=l.getShimContainer();n.innerHTML='\x3cinput id\x3d"'+l.uid+'" type\x3d"file" style\x3d"font-size:999px;opacity:0;"'+(e.multiple&&l.can("select_multiple")?"multiple":"")+(e.directory&&l.can("select_folder")?"webkitdirectory directory":"")+(k?' accept\x3d"'+k.join(",")+'"':"")+" /\x3e";k=c.get(l.uid);h.extend(k.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});t=c.get(e.browse_button);l.can("summon_file_dialog")&&("static"===c.getStyle(t,"position")&&(t.style.position="relative"),m=parseInt(c.getStyle(t,"z-index"),10)||1,t.style.zIndex=m,n.style.zIndex=m-1,a.addEvent(t,"click",function(a){var b=c.get(l.uid);b&&!b.disabled&&b.click();a.preventDefault()},f.uid));n=l.can("summon_file_dialog")?t:n;a.addEvent(n,"mouseover",function(){f.trigger("mouseenter")},f.uid);a.addEvent(n,"mouseout",function(){f.trigger("mouseleave")},f.uid);a.addEvent(n,"mousedown",function(){f.trigger("mousedown")},f.uid);a.addEvent(c.get(e.container),"mouseup",function(){f.trigger("mouseup")},f.uid);k.onchange=function r(){d=[];e.directory?h.each(this.files,function(a){"."!==a.name&&d.push(a)}):d=[].slice.call(this.files);if("IE"!==g.browser)this.value="";else{var a=this.cloneNode(!0);this.parentNode.replaceChild(a,this);a.onchange=r}f.trigger("change")};f.trigger({type:"ready",async:!0});n=null},getFiles:function(){return d},disable:function(a){var b=this.getRuntime();if(b=c.get(b.uid))b.disabled=!!a},destroy:function(){var b=this.getRuntime(),g=b.getShim(),b=b.getShimContainer();a.removeAllEvents(b,this.uid);a.removeAllEvents(e&&c.get(e.container),this.uid);a.removeAllEvents(e&&c.get(e.browse_button),this.uid);b&&(b.innerHTML="");g.removeInstance(this.uid);d=e=null}})}});p("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(f,h,c,a,b){return f.FileDrop=function(){function g(a){for(var b=[],c=0;c<a.length;c++)[].push.apply(b,a[c].extensions.split(/\s*,\s*/));return-1===h.inArray("*",b)?b:[]}function d(a){a=b.getFileExtension(a.name);return!a||!n.length||-1!==h.inArray(a,n)}function e(a,b){var c=[];h.each(a,function(a){c.push(function(b){k(a,b)})});h.inSeries(c,function(){b()})}function k(a,b){a.isFile?a.file(function(a){d(a)&&l.push(a);b()},function(){b()}):a.isDirectory?f(a,b):b()}function f(a,b){function c(a){k.readEntries(function(b){b.length?([].push.apply(d,b),c(a)):a()},a)}var d=[],k=a.createReader();c(function(){e(d,b)})}var l=[],n=[],t;h.extend(this,{init:function(b){var c=this;t=b;n=g(t.accept);b=t.container;a.addEvent(b,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},c.uid);a.addEvent(b,"drop",function(a){a.preventDefault();a.stopPropagation();l=[];if(a.dataTransfer.items&&a.dataTransfer.items[0].webkitGetAsEntry){var b=[];h.each(a.dataTransfer.items,function(a){b.push(a.webkitGetAsEntry())});e(b,function(){c.trigger("drop")})}else h.each(a.dataTransfer.files,function(a){d(a)&&l.push(a)}),c.trigger("drop")},c.uid);a.addEvent(b,"dragenter",function(a){a.preventDefault();a.stopPropagation();c.trigger("dragenter")},c.uid);a.addEvent(b,"dragleave",function(a){a.preventDefault();a.stopPropagation();c.trigger("dragleave")},c.uid)},getFiles:function(){return l},destroy:function(){a.removeAllEvents(t&&c.get(t.container),this.uid);l=n=t=null}})}});p("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(f,h,c){return f.FileReader=function(){var a,b=!1;c.extend(this,{read:function(g,d){var e=this;a=new window.FileReader;a.addEventListener("progress",function(a){e.trigger(a)});a.addEventListener("load",function(a){e.trigger(a)});a.addEventListener("error",function(b){e.trigger(b,a.error)});a.addEventListener("loadend",function(){a=null});"function"===c.typeOf(a[g])?(b=!1,a[g](d.getSource())):"readAsBinaryString"===g&&(b=!0,a.readAsDataURL(d.getSource()))},getResult:function(){var c;a&&a.result?b?(c=a.result,c=h.atob(c.substring(c.indexOf("base64,")+7))):c=a.result:c=null;return c},abort:function(){a&&a.abort()},destroy:function(){a=null}})}});p("moxie/runtime/html5/xhr/XMLHttpRequest","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env".split(" "),function(f,h,c,a,b,g,d,e,k){return f.XMLHttpRequest=function(){function f(a,b){var c=this,d,e;d=b.getBlob().getSource();e=new window.FileReader;e.onload=function(){b.append(b.getBlobName(),new g(null,{type:d.type,data:e.result}));t.send.call(c,a,b)};e.readAsBinaryString(d)}function l(){if(!window.XMLHttpRequest||"IE"===k.browser&&8>k.version){var a;a:{for(var b=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break a}catch(w){}a=void 0}return a}return new window.XMLHttpRequest}function n(a){var b="----moxieboundary"+(new Date).getTime(),c="";if(!this.getRuntime().can("send_binary_string"))throw new e.RuntimeError(e.RuntimeError.NOT_SUPPORTED_ERR);m.setRequestHeader("Content-Type","multipart/form-data; boundary\x3d"+b);a.each(function(a,d){c=a instanceof g?c+("--"+b+'\r\nContent-Disposition: form-data; name\x3d"'+d+'"; filename\x3d"'+unescape(encodeURIComponent(a.name||"blob"))+'"\r\nContent-Type: '+a.type+"\r\n\r\n"+a.getSource()+"\r\n"):c+("--"+b+'\r\nContent-Disposition: form-data; name\x3d"'+d+'"\r\n\r\n'+unescape(encodeURIComponent(a))+"\r\n")});return c+="--"+b+"--\r\n"}var t=this,m,D;h.extend(this,{send:function(b,c){var e=this,t="Mozilla"===k.browser&&4<=k.version&&7>k.version,q="Android Browser"===k.browser,r=!1;D=b.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase();m=l();m.open(b.method,b.url,b.async,b.user,b.password);if(c instanceof g)c.isDetached()&&(r=!0),c=c.getSource();else if(c instanceof d){if(c.hasBlob())if(c.getBlob().isDetached())c=n.call(e,c),r=!0;else if((t||q)&&"blob"===h.typeOf(c.getBlob().getSource())&&window.FileReader){f.call(e,b,c);return}if(c instanceof d){var u=new window.FormData;c.each(function(a,b){a instanceof g?u.append(b,a.getSource()):u.append(b,a)});c=u}}m.upload?(b.withCredentials&&(m.withCredentials=!0),m.addEventListener("load",function(a){e.trigger(a)}),m.addEventListener("error",function(a){e.trigger(a)}),m.addEventListener("progress",function(a){e.trigger(a)}),m.upload.addEventListener("progress",function(a){e.trigger({type:"UploadProgress",loaded:a.loaded,total:a.total})})):m.onreadystatechange=function(){switch(m.readyState){case 3:var c,d;try{a.hasSameOrigin(b.url)&&(c=m.getResponseHeader("Content-Length")||0),m.responseText&&(d=m.responseText.length)}catch(P){c=d=0}e.trigger({type:"progress",lengthComputable:!!c,total:parseInt(c,10),loaded:d});break;case 4:m.onreadystatechange=function(){},0===m.status?e.trigger("error"):e.trigger("load")}};h.isEmptyObj(b.headers)||h.each(b.headers,function(a,b){m.setRequestHeader(b,a)});""!==b.responseType&&"responseType"in m&&("json"!==b.responseType||k.can("return_response_type","json")?m.responseType=b.responseType:m.responseType="text");r?m.sendAsBinary?m.sendAsBinary(c):function(){for(var a=new Uint8Array(c.length),b=0;b<c.length;b++)a[b]=c.charCodeAt(b)&255;m.send(a.buffer)}():m.send(c);e.trigger("loadstart")},getStatus:function(){try{if(m)return m.status}catch(r){}return 0},getResponse:function(a){var d=this.getRuntime();try{switch(a){case "blob":var e=new b(d.uid,m.response),f=m.getResponseHeader("Content-Disposition");if(f){var g=f.match(/filename=([\'\"'])([^\1]+)\1/);g&&(D=g[2])}e.name=D;e.type||(e.type=c.getFileMime(D));return e;case "json":return k.can("return_response_type","json")?m.response:200===m.status&&window.JSON?JSON.parse(m.responseText):null;case "document":var l;var h=m.responseXML,n=m.responseText;"IE"===k.browser&&n&&h&&!h.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(m.getResponseHeader("Content-Type"))&&(h=new window.ActiveXObject("Microsoft.XMLDOM"),h.async=!1,h.validateOnParse=!1,h.loadXML(n));l=h&&("IE"===k.browser&&0!==h.parseError||!h.documentElement||"parsererror"===h.documentElement.tagName)?null:h;return l;default:return""!==m.responseText?m.responseText:null}}catch(G){return null}},getAllResponseHeaders:function(){try{return m.getAllResponseHeaders()}catch(r){}return""},abort:function(){m&&m.abort()},destroy:function(){t=D=null}})}});p("moxie/runtime/html5/utils/BinaryReader",[],function(){return function(){function f(b,f){var d=c?0:-8*(f-1),e=0,k;for(k=0;k<f;k++)e|=a.charCodeAt(b+k)<<Math.abs(d+8*k);return e}function h(b,c,d){d=3===arguments.length?d:a.length-c-1;a=a.substr(0,c)+b+a.substr(d+c)}var c=!1,a;return{II:function(a){if(a===B)return c;c=a},init:function(b){c=!1;a=b},SEGMENT:function(b,c,d){switch(arguments.length){case 1:return a.substr(b,a.length-b-1);case 2:return a.substr(b,c);case 3:h(d,b,c);break;default:return a}},BYTE:function(a){return f(a,1)},SHORT:function(a){return f(a,2)},LONG:function(a,g){if(g===B)return f(a,4);var b="",e=c?0:-24,k;for(k=0;4>k;k++)b+=String.fromCharCode(g>>Math.abs(e+8*k)&255);h(b,a,4)},SLONG:function(a){a=f(a,4);return 2147483647<a?a-4294967296:a},STRING:function(a,c){var b="";for(c+=a;a<c;a++)b+=String.fromCharCode(f(a,1));return b}}}});p("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader"],function(f){return function c(a){var b=[],g,d,e,k=0;g=new f;g.init(a);if(65496===g.SHORT(0)){for(d=2;d<=a.length;)if(e=g.SHORT(d),65488<=e&&65495>=e)d+=2;else{if(65498===e||65497===e)break;k=g.SHORT(d+2)+2;65505<=e&&65519>=e&&b.push({hex:e,name:"APP"+(e&15),start:d,length:k,segment:g.SEGMENT(d,k)});d+=k}g.init(null);return{headers:b,restore:function(a){var c;g.init(a);d=65504==g.SHORT(2)?4+g.SHORT(4):2;c=0;for(a=b.length;c<a;c++)g.SEGMENT(d,0,b[c].segment),d+=b[c].length;a=g.SEGMENT();g.init(null);return a},strip:function(a){var b,d;d=new c(a);b=d.headers;d.purge();g.init(a);for(a=b.length;a--;)g.SEGMENT(b[a].start,b[a].length,"");a=g.SEGMENT();g.init(null);return a},get:function(a){for(var c=[],d=0,e=b.length;d<e;d++)b[d].name===a.toUpperCase()&&c.push(b[d].segment);return c},set:function(a,c){var d=[],e,k,f;"string"===typeof c?d.push(c):d=c;e=k=0;for(f=b.length;e<f&&!(b[e].name===a.toUpperCase()&&(b[e].segment=d[k],b[e].length=d[k].length,k++),k>=d.length);e++);},purge:function(){b=[];g.init(null);g=null}}}}});p("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(f,h){return function(){function c(b,c){var k=a.SHORT(b),f,g,h,q,r,u,p={};for(f=0;f<k;f++)if(r=b+12*f+2,h=c[a.SHORT(r)],h!==B){g=a.SHORT(r+=2);q=a.LONG(r+=2);r+=4;u=[];switch(g){case 1:case 7:4<q&&(r=a.LONG(r)+d.tiffHeader);for(g=0;g<q;g++)u[g]=a.BYTE(r+g);break;case 2:4<q&&(r=a.LONG(r)+d.tiffHeader);p[h]=a.STRING(r,q-1);continue;case 3:2<q&&(r=a.LONG(r)+d.tiffHeader);for(g=0;g<q;g++)u[g]=a.SHORT(r+2*g);break;case 4:1<q&&(r=a.LONG(r)+d.tiffHeader);for(g=0;g<q;g++)u[g]=a.LONG(r+4*g);break;case 5:r=a.LONG(r)+d.tiffHeader;for(g=0;g<q;g++)u[g]=a.LONG(r+4*g)/a.LONG(r+4*g+4);break;case 9:r=a.LONG(r)+d.tiffHeader;for(g=0;g<q;g++)u[g]=a.SLONG(r+4*g);break;case 10:r=a.LONG(r)+d.tiffHeader;for(g=0;g<q;g++)u[g]=a.SLONG(r+4*g)/a.SLONG(r+4*g+4);break;default:continue}q=1==q?u[0]:u;e.hasOwnProperty(h)&&"object"!=typeof q?p[h]=e[h][q]:p[h]=q}return p}var a,b,g,d={},e;a=new h;b={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};e={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};return{init:function(e){d={tiffHeader:10};if(e===B||!e.length)return!1;a.init(e);return 65505===a.SHORT(0)&&"EXIF\x00"===a.STRING(4,5).toUpperCase()?(e=d.tiffHeader,a.II(18761==a.SHORT(e)),42!==a.SHORT(e+=2)?e=!1:(d.IFD0=d.tiffHeader+a.LONG(e+2),g=c(d.IFD0,b.tiff),"ExifIFDPointer"in g&&(d.exifIFD=d.tiffHeader+g.ExifIFDPointer,delete g.ExifIFDPointer),"GPSInfoIFDPointer"in g&&(d.gpsIFD=d.tiffHeader+g.GPSInfoIFDPointer,delete g.GPSInfoIFDPointer),e=!0),e):!1},TIFF:function(){return g},EXIF:function(){var a;a=c(d.exifIFD,b.exif);if(a.ExifVersion&&"array"===f.typeOf(a.ExifVersion)){for(var e=0,g="";e<a.ExifVersion.length;e++)g+=String.fromCharCode(a.ExifVersion[e]);a.ExifVersion=g}return a},GPS:function(){var a;a=c(d.gpsIFD,b.gps);a.GPSVersionID&&"array"===f.typeOf(a.GPSVersionID)&&(a.GPSVersionID=a.GPSVersionID.join("."));return a},setExif:function(c,e){if("PixelXDimension"!==c&&"PixelYDimension"!==c)return!1;var g;g=c;var f,k,h,q=0;if("string"===typeof g)for(k in f=b.exif,f)if(f[k]===g){g=k;break}f=d.exifIFD;k=a.SHORT(f);for(var r=0;r<k;r++)if(h=f+12*r+2,a.SHORT(h)==g){q=h+8;break}q?(a.LONG(q,e),g=!0):g=!1;return g},getBinary:function(){return a.SEGMENT()},purge:function(){a.init(null);a=g=null;d={}}}}});p("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(f,h,c,a,b){return function(g){var d,e,k,q,l,n;d=g;e=new a;e.init(d);if(65496!==e.SHORT(0))throw new h.ImageError(h.ImageError.WRONG_FORMAT);k=new c(g);q=new b;n=!!q.init(k.get("app1")[0]);l=function(){for(var a=0,b;a<=d.length;){b=e.SHORT(a+=2);if(65472<=b&&65475>=b)return a+=5,{height:e.SHORT(a),width:e.SHORT(a+2)};b=e.SHORT(a+=2);a+=b-2}return null}.call(this);f.extend(this,{type:"image/jpeg",size:d.length,width:l&&l.width||0,height:l&&l.height||0,setExif:function(a,b){if(!n)return!1;"object"===f.typeOf(a)?f.each(a,function(a,b){q.setExif(b,a)}):q.setExif(a,b);k.set("app1",q.getBinary())},writeHeaders:function(){return arguments.length?k.restore(arguments[0]):d=k.restore(d)},stripHeaders:function(a){return k.strip(a)},purge:function(){q&&k&&e&&(q.purge(),k.purge(),e.init(null),d=l=k=q=e=null)}});n&&(this.meta={tiff:q.TIFF(),exif:q.EXIF(),gps:q.GPS()})}});p("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(f,h,c){return function(a){function b(){d&&(d.init(null),g=e=d=null)}var g,d,e;g=a;d=new c;d.init(g);(function(){var a=0,b,c=[35152,20039,3338,6666];for(b=0;b<c.length;b++,a+=2)if(c[b]!=d.SHORT(a))throw new f.ImageError(f.ImageError.WRONG_FORMAT);})();e=function(){var a=8,b,c,e;b=d.LONG(a);c=d.STRING(a+=4,4);e=a+=4;d.LONG(a+b);return"IHDR"==c?{width:d.LONG(e),height:d.LONG(e+4)}:null}.call(this);h.extend(this,{type:"image/png",size:g.length,width:e.width,height:e.height,purge:function(){b.call(this)}});b.call(this)}});p("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(f,h,c,a){return function(b){var g=[c,a],d;d=function(){for(var a=0;a<g.length;a++)try{return new g[a](b)}catch(k){}throw new h.ImageError(h.ImageError.WRONG_FORMAT);}();f.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},stripHeaders:function(a){return a},purge:function(){}});f.extend(this,d);this.purge=function(){d.purge();d=null}}});p("moxie/runtime/html5/image/MegaPixel",[],function(){function f(f){var c=f.naturalWidth;if(1048576<c*f.naturalHeight){var a=document.createElement("canvas");a.width=a.height=1;a=a.getContext("2d");a.drawImage(f,-c+1,0);return 0===a.getImageData(0,0,1,1).data[3]}return!1}return{isSubsampled:f,renderTo:function(h,c,a){var b=h.naturalWidth,g=h.naturalHeight,d=a.width,e=a.height,k=a.x||0;a=a.y||0;c=c.getContext("2d");f(h)&&(b/=2,g/=2);var q=document.createElement("canvas");q.width=q.height=1024;var l=q.getContext("2d"),n;n=g;var t=document.createElement("canvas");t.width=1;t.height=n;t=t.getContext("2d");t.drawImage(h,0,0);for(var t=t.getImageData(0,0,1,n).data,m=0,p=n,r=n;r>m;)0===t[4*(r-1)+3]?p=r:m=r,r=p+m>>1;n=r/n;n=0===n?1:n;for(t=0;t<g;){m=t+1024>g?g-t:1024;for(p=0;p<b;)r=p+1024>b?b-p:1024,l.clearRect(0,0,1024,1024),l.drawImage(h,-p,-t),c.drawImage(q,0,0,r,m,p*d/b+k<<0,t*e/g/n+a<<0,Math.ceil(r*d/b),Math.ceil(m*e/g/n)),p+=1024;t+=1024}}}});p("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/File moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/MegaPixel moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(f,h,c,a,b,g,d,e,k){return f.Image=function(){function f(){if(!w&&!u)throw new c.ImageError(c.DOMException.INVALID_STATE_ERR);return w||u}function l(b){return a.atob(b.substring(b.indexOf("base64,")+7))}function n(b){var d=this;u=new Image;u.onerror=function(){p.call(this);d.trigger("error",new c.ImageError(c.ImageError.WRONG_FORMAT))};u.onload=function(){d.trigger("load")};u.src=/^data:[^;]*;base64,/.test(b)?b:"data:"+(E.type||"")+";base64,"+a.btoa(b)}function t(a,b){var d=this,e;if(window.FileReader)e=new FileReader,e.onload=function(){b(this.result)},e.onerror=function(){d.trigger("error",new c.FileException(c.FileException.NOT_READABLE_ERR))},e.readAsDataURL(a);else return b(a.getAsDataURL())}function m(a,b,c,e){var g,l=0,n=0,m,q;I=e;q=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;-1!==h.inArray(q,[5,6,7,8])&&(m=a,a=b,b=m);m=f();g=(c?Math.max:Math.min)(a/m.width,b/m.height);if(!(1<g)||c&&!e){w||(w=document.createElement("canvas"));e=Math.round(m.width*g);g=Math.round(m.height*g);c?(w.width=a,w.height=b,e>a&&(l=Math.round((e-a)/2)),g>b&&(n=Math.round((g-b)/2))):(w.width=e,w.height=g);if(!I){a=w.width;b=w.height;switch(q){case 5:case 6:case 7:case 8:w.width=b;w.height=a;break;default:w.width=a,w.height=b}c=w.getContext("2d");switch(q){case 2:c.translate(a,0);c.scale(-1,1);break;case 3:c.translate(a,b);c.rotate(Math.PI);break;case 4:c.translate(0,b);c.scale(1,-1);break;case 5:c.rotate(.5*Math.PI);c.scale(1,-1);break;case 6:c.rotate(.5*Math.PI);c.translate(0,-b);break;case 7:c.rotate(.5*Math.PI);c.translate(a,-b);c.scale(-1,1);break;case 8:c.rotate(-.5*Math.PI),c.translate(-a,0)}}q=w;l=-l;n=-n;"iOS"===k.OS?d.renderTo(m,q,{width:e,height:g,x:l,y:n}):q.getContext("2d").drawImage(m,l,n,e,g);this.width=w.width;this.height=w.height;F=!0}this.trigger("Resize")}function p(){v&&(v.purge(),v=null);x=u=w=E=null;F=!1}var r=this,u,v,w,x,E,F=!1,I=!0;h.extend(this,{loadFromBlob:function(a){var b=this,d=b.getRuntime(),e=1<arguments.length?arguments[1]:!0;if(!d.can("access_binary"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);E=a;a.isDetached()?(x=a.getSource(),n.call(this,x)):t.call(this,a.getSource(),function(a){e&&(x=l(a));n.call(b,a)})},loadFromImage:function(a,c){this.meta=a.meta;E=new b(null,{name:a.name,size:a.size,type:a.type});n.call(this,c?x=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var a=this.getRuntime();!v&&x&&a.can("access_image_binary")&&(v=new g(x));return{width:f().width||0,height:f().height||0,type:E.type||e.getFileMime(E.name),size:x&&x.length||E.size||0,name:E.name||"",meta:v&&v.meta||this.meta||{}}},downsize:function(){m.apply(this,arguments)},getAsCanvas:function(){w&&(w.id=this.uid+"_canvas");return w},getAsBlob:function(a,c){a!==this.type&&m.call(this,this.width,this.height,!1);return new b(null,{name:E.name||"",type:a,data:r.getAsBinaryString.call(this,a,c)})},getAsDataURL:function(a,b){var c=b||90;if(!F)return u.src;if("image/jpeg"!==a)return w.toDataURL("image/png");try{return w.toDataURL("image/jpeg",c/100)}catch(N){return w.toDataURL("image/jpeg")}},getAsBinaryString:function(a,b){if(!F)return x||(x=l(r.getAsDataURL(a,b))),x;if("image/jpeg"!==a)x=l(r.getAsDataURL(a,b));else{var c;b||(b=90);try{c=w.toDataURL("image/jpeg",b/100)}catch(N){c=w.toDataURL("image/jpeg")}x=l(c);v&&(x=v.stripHeaders(x),I&&(v.meta&&v.meta.exif&&v.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),x=v.writeHeaders(x)),v.purge(),v=null)}F=!1;return x},destroy:function(){r=null;p.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});p("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(f,h,c,a,b){function g(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(k){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(q){a="0.0"}}a=a.match(/\d+/g);return parseFloat(a[0]+"."+a[1])}var d={};b.addConstructor("flash",function(e){var k=this,q;e=f.extend({swf_url:h.swf_url},e);b.call(this,e,"flash",{access_binary:function(a){return a&&"browser"===k.mode},access_image_binary:function(a){return a&&"browser"===k.mode},display_media:b.capTrue,do_cors:b.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===k.mode},resize_image:b.capTrue,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!f.arrayDiff(a,["","text","document"])||"browser"===k.mode},return_status_code:function(a){return"browser"===k.mode||!f.arrayDiff(a,[200,404])},select_file:b.capTrue,select_multiple:b.capTrue,send_binary_string:function(a){return a&&"browser"===k.mode},send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"browser"===k.mode},send_multipart:b.capTrue,slice_blob:b.capTrue,stream_upload:function(a){return a&&"browser"===k.mode},summon_file_dialog:!1,upload_filesize:function(a){return 2097152>=f.parseSizeStr(a)||"client"===k.mode},use_http_method:function(a){return!f.arrayDiff(a,["GET","POST"])}},{access_binary:function(a){return a?"browser":"client"},access_image_binary:function(a){return a?"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(a){return f.arrayDiff(a,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(a){return f.arrayDiff(a,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"browser":"client"},stream_upload:function(a){return a?"client":"browser"},upload_filesize:function(a){return 2097152<=f.parseSizeStr(a)?"client":"browser"}},"client");10>g()&&(this.mode=!1);f.extend(this,{getShim:function(){return c.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){var b,c,d;d=this.getShimContainer();f.extend(d.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});b='\x3cobject id\x3d"'+this.uid+'" type\x3d"application/x-shockwave-flash" data\x3d"'+e.swf_url+'" ';"IE"===h.browser&&(b+='classid\x3d"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');b+='width\x3d"100%" height\x3d"100%" style\x3d"outline:0"\x3e\x3cparam name\x3d"movie" value\x3d"'+e.swf_url+'" /\x3e\x3cparam name\x3d"flashvars" value\x3d"uid\x3d'+escape(this.uid)+"\x26target\x3d"+h.global_event_dispatcher+'" /\x3e\x3cparam name\x3d"wmode" value\x3d"transparent" /\x3e\x3cparam name\x3d"allowscriptaccess" value\x3d"always" /\x3e\x3c/object\x3e';"IE"===h.browser?(c=document.createElement("div"),d.appendChild(c),c.outerHTML=b,c=d=null):d.innerHTML=b;q=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},5E3)},destroy:function(a){return function(){a.call(k);clearTimeout(q);e=q=a=k=null}}(this.destroy)},d)});return d});p("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(f,h){return f.Blob={slice:function(c,a,b,g){var d=this.getRuntime();0>a?a=Math.max(c.size+a,0):0<a&&(a=Math.min(a,c.size));0>b?b=Math.max(c.size+b,0):0<b&&(b=Math.min(b,c.size));(c=d.shimExec.call(this,"Blob","slice",a,b,g||""))&&(c=new h(d.uid,c));return c}}});p("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime"],function(f){return f.FileInput={init:function(f){this.getRuntime().shimExec.call(this,"FileInput","init",{name:f.name,accept:f.accept,multiple:f.multiple});this.trigger("ready")}}});p("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(f,h){function c(a,c){switch(c){case "readAsText":return h.atob(a,"utf8");case "readAsBinaryString":return h.atob(a);case "readAsDataURL":return a}return null}var a="";return f.FileReader={read:function(b,g){var d=this.getRuntime();"readAsDataURL"===b&&(a="data:"+(g.type||"")+";base64,");this.bind("Progress",function(d,g){g&&(a+=c(g,b))});return d.shimExec.call(this,"FileReader","readAsBase64",g.uid)},getResult:function(){return a},destroy:function(){a=null}}});p("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(f,h){function c(a,b){switch(b){case "readAsText":return h.atob(a,"utf8");case "readAsBinaryString":return h.atob(a);case "readAsDataURL":return a}return null}return f.FileReaderSync={read:function(a,b){var g;g=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",b.uid);if(!g)return null;"readAsDataURL"===a&&(g="data:"+(b.type||"")+";base64,"+g);return c(g,a,b.type)}}});p("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter".split(" "),function(f,h,c,a,b,g,d){return f.XMLHttpRequest={send:function(a,b){function e(){a.transport=m.mode;m.shimExec.call(t,"XMLHttpRequest","send",a,b)}function f(a,c){m.shimExec.call(t,"XMLHttpRequest","appendBlob",a,c.uid);b=null;e()}function k(a,b){var c=new d;c.bind("TransportingComplete",function(){b(this.result)});c.transport(a.getSource(),a.type,{ruid:m.uid})}var t=this,m=t.getRuntime();h.isEmptyObj(a.headers)||h.each(a.headers,function(a,b){m.shimExec.call(t,"XMLHttpRequest","setRequestHeader",b,a.toString())});if(b instanceof g){var p;b.each(function(a,b){a instanceof c?p=b:m.shimExec.call(t,"XMLHttpRequest","append",b,a)});if(b.hasBlob()){var r=b.getBlob();r.isDetached()?k(r,function(a){r.destroy();f(p,a)}):f(p,r)}else b=null,e()}else b instanceof c?b.isDetached()?k(b,function(a){b.destroy();b=a.uid;e()}):(b=b.uid,e()):e()},getResponse:function(c){var d,e,g=this.getRuntime();if(e=g.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){e=new a(g.uid,e);if("blob"===c)return e;try{d=new b;if(~h.inArray(c,["","text"]))return d.readAsText(e);if("json"===c&&window.JSON)return JSON.parse(d.readAsText(e))}finally{e.destroy()}}return null},abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});p("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(f,h){return f.Transporter={getAsBlob:function(c){var a=this.getRuntime();return(c=a.shimExec.call(this,"Transporter","getAsBlob",c))?new h(a.uid,c):null}}});p("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(f,h,c,a,b){return f.Image={loadFromBlob:function(a){function b(a){g.shimExec.call(e,"Image","loadFromBlob",a.uid);e=g=null}var e=this,g=e.getRuntime();if(a.isDetached()){var f=new c;f.bind("TransportingComplete",function(){b(f.result.getSource())});f.transport(a.getSource(),a.type,{ruid:g.uid})}else b(a.getSource())},loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getAsBlob:function(b,c){var d=this.getRuntime(),g=d.shimExec.call(this,"Image","getAsBlob",b,c);return g?new a(d.uid,g):null},getAsDataURL:function(){var a=this.getRuntime().Image.getAsBlob.apply(this,arguments);return a?(new b).readAsDataURL(a):null}}});p("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(f,h,c,a,b){function g(a){var b=!1,c=null,d,e,g,f,h,r=0;try{try{c=new ActiveXObject("AgControl.AgControl"),c.IsVersionSupported(a)&&(b=!0)}catch(v){var p=navigator.plugins["Silverlight Plug-In"];if(p){d=p.description;"1.0.30226.2"===d&&(d="2.0.30226.2");for(e=d.split(".");3<e.length;)e.pop();for(;4>e.length;)e.push(0);for(g=a.split(".");4<g.length;)g.pop();do f=parseInt(g[r],10),h=parseInt(e[r],10),r++;while(r<g.length&&f===h);f<=h&&!isNaN(f)&&(b=!0)}}}catch(v){b=!1}return b}var d={};b.addConstructor("silverlight",function(e){var k=this,q;e=f.extend({xap_url:h.xap_url},e);b.call(this,e,"silverlight",{access_binary:b.capTrue,access_image_binary:b.capTrue,display_media:b.capTrue,do_cors:b.capTrue,drag_and_drop:!1,report_upload_progress:b.capTrue,resize_image:b.capTrue,return_response_headers:function(a){return a&&"client"===k.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(a){return"client"===k.mode||!f.arrayDiff(a,[200,404])},select_file:b.capTrue,select_multiple:b.capTrue,send_binary_string:b.capTrue,send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"client"===k.mode},send_multipart:b.capTrue,slice_blob:b.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:b.capTrue,use_http_method:function(a){return"client"===k.mode||!f.arrayDiff(a,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(a){return f.arrayDiff(a,[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(a){return f.arrayDiff(a,["GET","POST"])?"client":["client","browser"]}});g("2.0.31005.0")&&"Opera"!==h.browser||(this.mode=!1);f.extend(this,{getShim:function(){return c.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){this.getShimContainer().innerHTML='\x3cobject id\x3d"'+this.uid+'" data\x3d"data:application/x-silverlight," type\x3d"application/x-silverlight-2" width\x3d"100%" height\x3d"100%" style\x3d"outline:none;"\x3e\x3cparam name\x3d"source" value\x3d"'+e.xap_url+'"/\x3e\x3cparam name\x3d"background" value\x3d"Transparent"/\x3e\x3cparam name\x3d"windowless" value\x3d"true"/\x3e\x3cparam name\x3d"enablehtmlaccess" value\x3d"true"/\x3e\x3cparam name\x3d"initParams" value\x3d"uid\x3d'+this.uid+",target\x3d"+h.global_event_dispatcher+'"/\x3e\x3c/object\x3e';q=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},"Windows"!==h.OS?1E4:5E3)},destroy:function(a){return function(){a.call(k);clearTimeout(q);e=q=a=k=null}}(this.destroy)},d)});return d});p("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(f,h,c){return f.Blob=h.extend({},c)});p("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime"],function(f){return f.FileInput={init:function(f){this.getRuntime().shimExec.call(this,"FileInput","init",function(c){for(var a="",b=0;b<c.length;b++)a+=(""!==a?"|":"")+c[b].title+" | *."+c[b].extensions.replace(/,/g,";*.");return a}(f.accept),f.name,f.multiple);this.trigger("ready")}}});p("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(f,h,c){return f.FileDrop={init:function(){var a=this.getRuntime(),b;b=a.getShimContainer();c.addEvent(b,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},this.uid);c.addEvent(b,"dragenter",function(b){b.preventDefault();h.get(a.uid).dragEnter(b)&&b.stopPropagation()},this.uid);c.addEvent(b,"drop",function(b){b.preventDefault();h.get(a.uid).dragDrop(b)&&b.stopPropagation()},this.uid);return a.shimExec.call(this,"FileDrop","init")}}});p("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(f,h,c){return f.FileReader=h.extend({},c)});p("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(f,h,c){return f.FileReaderSync=h.extend({},c)});p("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(f,h,c){return f.XMLHttpRequest=h.extend({},c)});p("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(f,h,c){return f.Transporter=h.extend({},c)});p("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/image/Image"],function(f,h,c){return f.Image=h.extend({},c,{getInfo:function(){var a=["tiff","exif","gps"],b={meta:{}},c=this.getRuntime().shimExec.call(this,"Image","getInfo");c.meta&&h.each(a,function(a){var d=c.meta[a],f,g,h,n;if(d&&d.keys)for(b.meta[a]={},g=0,h=d.keys.length;g<h;g++)if(f=d.keys[g],n=d[f])/^(\d|[1-9]\d+)$/.test(n)?n=parseInt(n,10):/^\d*\.\d+$/.test(n)&&(n=parseFloat(n)),b.meta[a][f]=n});b.width=parseInt(c.width,10);b.height=parseInt(c.height,10);b.size=parseInt(c.size,10);b.type=c.type;b.name=c.name;return b}})});p("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(f,h,c,a){var b={};c.addConstructor("html4",function(g){var d=this,e=c.capTest,h=c.capTrue;c.call(this,g,"html4",{access_binary:e(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:e(b.Image&&(a.can("create_canvas")||a.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:e("Chrome"===a.browser&&28<=a.version||"IE"===a.browser&&10<=a.version),resize_image:function(){return b.Image&&d.can("access_binary")&&a.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!!~f.inArray(a,["text","document",""])},return_status_code:function(a){return!f.arrayDiff(a,[200,404])},select_file:function(){return a.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return d.can("select_file")},summon_file_dialog:e("Firefox"===a.browser&&4<=a.version||"Opera"===a.browser&&12<=a.version||!!~f.inArray(a.browser,["Chrome","Safari"])),upload_filesize:h,use_http_method:function(a){return!f.arrayDiff(a,["GET","POST"])}});f.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(d);a=d=null}}(this.destroy)});f.extend(this.getShim(),b)});return b});p("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(f,h,c,a,b,g){return f.FileInput=function(){function d(){var b=this,k=b.getRuntime(),m,p,r,u,v;v=h.guid("uid_");m=k.getShimContainer();e&&(p=c.get(e+"_form"))&&h.extend(p.style,{top:"100%"});r=document.createElement("form");r.setAttribute("id",v+"_form");r.setAttribute("method","post");r.setAttribute("enctype","multipart/form-data");r.setAttribute("encoding","multipart/form-data");h.extend(r.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});u=document.createElement("input");u.setAttribute("id",v);u.setAttribute("type","file");u.setAttribute("name",l.name||"Filedata");u.setAttribute("accept",q.join(","));h.extend(u.style,{fontSize:"999px",opacity:0});r.appendChild(u);m.appendChild(r);h.extend(u.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});"IE"===g.browser&&10>g.version&&h.extend(u.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity\x3d0)"});u.onchange=function(){var a;this.value&&(a=this.files?this.files[0]:{name:this.value},f=[a],this.onchange=function(){},d.call(b),b.bind("change",function E(){var a=c.get(v),d=c.get(v+"_form"),e;b.unbind("change",E);b.files.length&&a&&d&&(e=b.files[0],a.setAttribute("id",e.uid),d.setAttribute("id",e.uid+"_form"),d.setAttribute("target",e.uid+"_iframe"))},998),u=r=null,b.trigger("change"))};k.can("summon_file_dialog")&&(k=c.get(l.browse_button),a.removeEvent(k,"click",b.uid),a.addEvent(k,"click",function(a){u&&!u.disabled&&u.click();a.preventDefault()},b.uid));e=v;m=p=k=null}var e,f=[],q=[],l;h.extend(this,{init:function(e){var f=this,g=f.getRuntime(),h;l=e;q=e.accept.mimes||b.extList2mimes(e.accept,g.can("filter_by_extension"));h=g.getShimContainer();(function(){var b,d;b=c.get(e.browse_button);g.can("summon_file_dialog")&&("static"===c.getStyle(b,"position")&&(b.style.position="relative"),d=parseInt(c.getStyle(b,"z-index"),10)||1,b.style.zIndex=d,h.style.zIndex=d-1);b=g.can("summon_file_dialog")?b:h;a.addEvent(b,"mouseover",function(){f.trigger("mouseenter")},f.uid);a.addEvent(b,"mouseout",function(){f.trigger("mouseleave")},f.uid);a.addEvent(b,"mousedown",function(){f.trigger("mousedown")},f.uid);a.addEvent(c.get(e.container),"mouseup",function(){f.trigger("mouseup")},f.uid);b=null})();d.call(this);h=null;f.trigger({type:"ready",async:!0})},getFiles:function(){return f},disable:function(a){var b;if(b=c.get(e))b.disabled=!!a},destroy:function(){var b=this.getRuntime(),d=b.getShim(),b=b.getShimContainer();a.removeAllEvents(b,this.uid);a.removeAllEvents(l&&c.get(l.container),this.uid);a.removeAllEvents(l&&c.get(l.browse_button),this.uid);b&&(b.innerHTML="");d.removeInstance(this.uid);e=f=q=l=null}})}});p("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(f,h){return f.FileReader=h});p("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData".split(" "),function(f,h,c,a,b,g,d,e){return f.XMLHttpRequest=function(){function f(a){var b=this,d,e,f,h=!1;if(n){d=n.id.replace(/_iframe$/,"");if(d=c.get(d+"_form")){e=d.getElementsByTagName("input");for(f=e.length;f--;)switch(e[f].getAttribute("type")){case "hidden":e[f].parentNode.removeChild(e[f]);break;case "file":h=!0}e=[];h||d.parentNode.removeChild(d);d=null}setTimeout(function(){g.removeEvent(n,"load",b.uid);n.parentNode&&n.parentNode.removeChild(n);var c=b.getRuntime().getShimContainer();c.children.length||c.parentNode.removeChild(c);n=null;a()},1)}}var q,l,n;h.extend(this,{send:function(k,m){var p=this,r=p.getRuntime(),t,v,w,x;q=l=null;if(m instanceof e&&m.hasBlob()){if(x=m.getBlob(),t=x.uid,w=c.get(t),v=c.get(t+"_form"),!v)throw new b.DOMException(b.DOMException.NOT_FOUND_ERR);}else t=h.guid("uid_"),v=document.createElement("form"),v.setAttribute("id",t+"_form"),v.setAttribute("method",k.method),v.setAttribute("enctype","multipart/form-data"),v.setAttribute("encoding","multipart/form-data"),v.setAttribute("target",t+"_iframe"),r.getShimContainer().appendChild(v);m instanceof e&&m.each(function(a,b){if(a instanceof d)w&&w.setAttribute("name",b);else{var c=document.createElement("input");h.extend(c,{type:"hidden",name:b,value:a});w?v.insertBefore(c,w):v.appendChild(c)}});v.setAttribute("action",k.url);(function(){var b=r.getShimContainer()||document.body,c=document.createElement("div");c.innerHTML='\x3ciframe id\x3d"'+t+'_iframe" name\x3d"'+t+'_iframe" src\x3d"javascript:\x26quot;\x26quot;" style\x3d"display:none"\x3e\x3c/iframe\x3e';n=c.firstChild;b.appendChild(n);g.addEvent(n,"load",function(){var b;try{b=n.contentWindow.document||n.contentDocument||window.frames[n.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(b.title)?q=b.title.replace(/^(\d+).*$/,"$1"):(q=200,l=h.trim(b.body.innerHTML),p.trigger({type:"progress",loaded:l.length,total:l.length}),x&&p.trigger({type:"uploadprogress",loaded:x.size||1025,total:x.size||1025}))}catch(G){if(a.hasSameOrigin(k.url))q=404;else{f.call(p,function(){p.trigger("error")});return}}f.call(p,function(){p.trigger("load")})},p.uid)})();v.submit();p.trigger("loadstart")},getStatus:function(){return q},getResponse:function(a){if("json"===a&&"string"===h.typeOf(l)&&window.JSON)try{return JSON.parse(l.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(m){return null}return l},abort:function(){var a=this;n&&n.contentWindow&&(n.contentWindow.stop?n.contentWindow.stop():n.contentWindow.document.execCommand?n.contentWindow.document.execCommand("Stop"):n.src="about:blank");f.call(this,function(){a.dispatchEvent("abort")})}})}});p("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(f,h){return f.Image=h});(function(f){for(var h=0;h<f.length;h++){for(var c=A,a=f[h],b=a.split(/[.\/]/),g=0;g<b.length-1;++g)c[b[g]]===B&&(c[b[g]]={}),c=c[b[g]];c[b[b.length-1]]=C[a]}})("moxie/core/utils/Basic moxie/core/I18n moxie/core/utils/Mime moxie/core/utils/Env moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/Blob moxie/file/File moxie/file/FileInput moxie/file/FileDrop moxie/runtime/RuntimeTarget moxie/file/FileReader moxie/core/utils/Url moxie/file/FileReaderSync moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/runtime/Transporter moxie/image/Image moxie/core/utils/Events".split(" "))})(this);(function(){var A={},B=moxie.core.utils.Basic.inArray;(function p(C){var f,h;for(f in C)h=typeof C[f],"object"!==h||~B(f,["Exceptions","Env","Mime"])?"function"===h&&(A[f]=C[f]):p(C[f])})(window.moxie);A.Env=window.moxie.core.utils.Env;A.Mime=window.moxie.core.utils.Mime;A.Exceptions=window.moxie.core.Exceptions;window.mOxie=A;window.o||(window.o=A);return A})();